{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}}],"generated":{"js":"var Crafty = require('../core/core.js');\n\n\nCrafty.extend({\n    /**@\n     * #Crafty.isometric\n     * @category 2D\n     * @kind CoreObject\n     * \n     * Place entities in a 45deg isometric fashion. The alignment of this\n     * grid's axes for tile placement is 90 degrees.  If you are looking\n     * to have the grid of tile indicies for this.place aligned to the tiles\n     * themselves, use DiamondIso instead.\n     */\n    isometric: {\n        _tile: {\n            width: 0,\n            height: 0\n        },\n        _elements: {},\n        _pos: {\n            x: 0,\n            y: 0\n        },\n        _z: 0,\n        /**@\n         * #Crafty.isometric.size\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public this Crafty.isometric.size(Number tileSize)\n         * @param tileSize - The size of the tiles to place.\n         *\n         * Method used to initialize the size of the isometric placement.\n         * Recommended to use a size values in the power of `2` (128, 64 or 32).\n         * This makes it easy to calculate positions and implement zooming.\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128);\n         * ~~~\n         *\n         * @see Crafty.isometric.place\n         */\n        size: function (width, height) {\n            this._tile.width = width;\n            this._tile.height = height > 0 ? height : width / 2; //Setup width/2 if height isn't set\n            return this;\n        },\n        /**@\n         * #Crafty.isometric.place\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public this Crafty.isometric.place(Number x, Number y, Number z, Entity tile)\n         * @param x - The `x` position to place the tile\n         * @param y - The `y` position to place the tile\n         * @param z - The `z` position or height to place the tile\n         * @param tile - The entity that should be position in the isometric fashion\n         *\n         * Use this method to place an entity in an isometric grid.\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128);\n         * iso.place(2, 1, 0, Crafty.e('2D, DOM, Color').color('red').attr({w:128, h:128}));\n         * ~~~\n         *\n         * @see Crafty.isometric.size\n         */\n        place: function (x, y, z, obj) {\n            var pos = this.pos2px(x, y);\n            pos.top -= z * (this._tile.height / 2);\n            obj.x = pos.left + Crafty.viewport._x;\n            obj.y = pos.top + Crafty.viewport._y;\n            obj.z += z;\n            return this;\n        },\n        /**@\n         * #Crafty.isometric.pos2px\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public Object Crafty.isometric.pos2px(Number x,Number y)\n         * @param x - A position along the x axis\n         * @param y - A position along the y axis\n         * @return An object with `left` and `top` fields {left Number,top Number}\n         *\n         * This method converts a position in x and y coordinates to one in pixels\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128,96);\n         * var position = iso.pos2px(100,100); //Object { left=12800, top=4800}\n         * ~~~\n         */\n        pos2px: function (x, y) {\n            return {\n                left: x * this._tile.width + (y & 1) * (this._tile.width / 2),\n                top: y * this._tile.height / 2\n            };\n        },\n        /**@\n         * #Crafty.isometric.px2pos\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public Object Crafty.isometric.px2pos(Number left,Number top)\n         * @param top - Offset from the top in pixels\n         * @param left - Offset from the left in pixels\n         * @return An object with `x` and `y` fields representing the position\n         *\n         * This method converts a position in pixels to x,y coordinates\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128,96);\n         * var px = iso.pos2px(12800,4800);\n         * Crafty.log(px); //Object { x=100, y=100}\n         * ~~~\n         */\n        px2pos: function (left, top) {\n            return {\n                x: -Math.ceil(-left / this._tile.width - (top & 1) * 0.5),\n                y: top / this._tile.height * 2\n            };\n        },\n        /**@\n         * #Crafty.isometric.centerAt\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public Obect Crafty.isometric.centerAt()\n         * @returns An object with `top` and `left` fields represneting the viewport's current center\n         *\n         * @sign public this Crafty.isometric.centerAt(Number x, Number y)\n         * @param x - The x position to center at\n         * @param y - The y position to center at\n         *\n         * This method centers the Viewport at an `x,y` location or gives the current centerpoint of the viewport\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128,96).centerAt(10,10); //Viewport is now moved\n         * //After moving the viewport by another event you can get the new center point\n         * Crafty.log(iso.centerAt());\n         * ~~~\n         */\n        centerAt: function (x, y) {\n            if (typeof x === \"number\" && typeof y === \"number\") {\n                var center = this.pos2px(x, y);\n                Crafty.viewport._x = -center.left + Crafty.viewport.width / 2 - this._tile.width / 2;\n                Crafty.viewport._y = -center.top + Crafty.viewport.height / 2 - this._tile.height / 2;\n                return this;\n            } else {\n                return {\n                    top: -Crafty.viewport._y + Crafty.viewport.height / 2 - this._tile.height / 2,\n                    left: -Crafty.viewport._x + Crafty.viewport.width / 2 - this._tile.width / 2\n                };\n            }\n        },\n        /**@\n         * #Crafty.isometric.area\n         * @comp Crafty.isometric\n         * @kind Method\n         * \n         * @sign public Object Crafty.isometric.area()\n         * @return An obect with `x` and `y` fields, each of which have a start and end field.\n         * In other words, the object has this structure: `{x:{start Number,end Number},y:{start Number,end Number}}`\n         *\n         * This method returns an object representing the bounds of the viewport\n         *\n         * @example\n         * ~~~\n         * var iso = Crafty.isometric.size(128,96).centerAt(10,10); //Viewport is now moved\n         * var area = iso.area(); //get the area\n         * for(var y = area.y.start;y <= area.y.end;y++){\n         *   for(var x = area.x.start ;x <= area.x.end;x++){\n         *       iso.place(x,y,0,Crafty.e(\"2D,DOM,gras\")); //Display tiles in the Screen\n         *   }\n         * }\n         * ~~~\n         */\n        area: function () {\n            //Get the center Point in the viewport\n            var center = this.centerAt();\n            var start = this.px2pos(-center.left + Crafty.viewport.width / 2, -center.top + Crafty.viewport.height / 2);\n            var end = this.px2pos(-center.left - Crafty.viewport.width / 2, -center.top - Crafty.viewport.height / 2);\n            return {\n                x: {\n                    start: start.x,\n                    end: end.x\n                },\n                y: {\n                    start: start.y,\n                    end: end.y\n                }\n            };\n        }\n    }\n});\n"},"hash":"3daf3c5e72073871eb9e0755977fc69d"}