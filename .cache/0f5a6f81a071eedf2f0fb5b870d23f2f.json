{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}},{"name":"./spatial-grid.js","loc":{"line":2,"column":22}}],"generated":{"js":"var t=require(\"../core/core.js\"),i=require(\"./spatial-grid.js\");t.map=new i;var h=Math,s=h.PI,n=s/180;t.c(\"2D\",{_x:0,_y:0,_w:0,_h:0,_z:0,_globalZ:null,_rotation:0,_origin:null,_mbr:null,_entry:null,_children:null,_parent:null,_2D_property_definitions:{x:{set:function(t){this._setter2d(\"_x\",t)},get:function(){return this._x},configurable:!0,enumerable:!0},_x:{enumerable:!1},y:{set:function(t){this._setter2d(\"_y\",t)},get:function(){return this._y},configurable:!0,enumerable:!0},_y:{enumerable:!1},w:{set:function(t){this._setter2d(\"_w\",t)},get:function(){return this._w},configurable:!0,enumerable:!0},_w:{enumerable:!1},h:{set:function(t){this._setter2d(\"_h\",t)},get:function(){return this._h},configurable:!0,enumerable:!0},_h:{enumerable:!1},z:{set:function(t){this._setter2d(\"_z\",t)},get:function(){return this._z},configurable:!0,enumerable:!0},_z:{enumerable:!1},rotation:{set:function(t){this._setter2d(\"_rotation\",t)},get:function(){return this._rotation},configurable:!0,enumerable:!0},_rotation:{enumerable:!1}},_define2DProperties:function(){for(var t in this._2D_property_definitions)Object.defineProperty(this,t,this._2D_property_definitions[t])},init:function(){this._globalZ=this[0],this._origin={x:0,y:0},this._bx1=0,this._bx2=0,this._by1=0,this._by2=0,this._children=[],this._define2DProperties(),this._entry=t.map.insert(this),this.bind(\"Move\",function(t){var i=this._cbr||this._mbr||this;this._entry.update(i),this._children.length>0&&this._cascade(t)}),this.bind(\"Rotate\",function(t){var i=this._cbr||this._mbr||this;this._entry.update(i),this._children.length>0&&this._cascade(t)}),this.bind(\"Remove\",function(){if(this._children){for(var i=0;i<this._children.length;i++)delete this._children[i]._parent,this._children[i].destroy&&this._children[i].destroy();this._children=[]}this._parent&&this._parent.detach(this),t.map.remove(this._entry),this.detach()})},offsetBoundary:function(t,i,h,s){return 1===arguments.length&&(i=h=s=t),this._bx1=t,this._bx2=h,this._by1=i,this._by2=s,this.trigger(\"BoundaryOffset\"),this._calculateMBR(),this},_calculateMBR:function(){var t=this._origin.x+this._x,i=this._origin.y+this._y,h=-this._rotation*n,s=this._x-this._bx1-t,r=this._x+this._w+this._bx2-t,e=this._y-this._by1-i,_=this._y+this._h+this._by2-i,o=Math.cos(h),a=Math.sin(h),c=s*(o=o<1e-10&&o>-1e-10?0:o)+e*(a=a<1e-10&&a>-1e-10?0:a),u=-s*a+e*o,l=r*o+e*a,f=-r*a+e*o,y=r*o+_*a,x=-r*a+_*o,g=s*o+_*a,b=-s*a+_*o,d=Math.floor(Math.min(c,l,y,g)+t),m=Math.floor(Math.min(u,f,x,b)+i),p=Math.ceil(Math.max(c,l,y,g)+t),w=Math.ceil(Math.max(u,f,x,b)+i);if(this._mbr?(this._mbr._x=d,this._mbr._y=m,this._mbr._w=p-d,this._mbr._h=w-m):this._mbr={_x:d,_y:m,_w:p-d,_h:w-m},this._cbr){var v=this._cbr,M=v.cx,R=v.cy,P=v.r,z=t+(M+this._x-t)*o+(R+this._y-i)*a,A=i-(M+this._x-t)*a+(R+this._y-i)*o;v._x=Math.min(z-P,d),v._y=Math.min(A-P,m),v._w=Math.max(z+P,p)-v._x,v._h=Math.max(A+P,w)-v._y}},_rotate:function(t){var i=this._rotation-t;if(0!==i){this._rotation=t;var h={x:this._origin.x+this._x,y:this._origin.y+this._y};this._calculateMBR();var s=i*n,r=Math.cos(s),e=Math.sin(s);this.trigger(\"Rotate\",{cos:-1e-10<r&&r<1e-10?0:r,sin:-1e-10<e&&e<1e-10?0:e,deg:i,rad:s,o:h})}},area:function(){return this._w*this._h},intersect:function(t,i,h,s){var n,r=this._mbr||this;return n=\"object\"==typeof t?t:{_x:t,_y:i,_w:h,_h:s},r._x<n._x+n._w&&r._x+r._w>n._x&&r._y<n._y+n._h&&r._y+r._h>n._y},within:function(t,i,h,s){var n,r=this._mbr||this;return(n=\"object\"==typeof t?t:{_x:t,_y:i,_w:h,_h:s})._x<=r._x&&n._x+n._w>=r._x+r._w&&n._y<=r._y&&n._y+n._h>=r._y+r._h},contains:function(t,i,h,s){var n,r=this._mbr||this;return(n=\"object\"==typeof t?t:{_x:t,_y:i,_w:h,_h:s})._x>=r._x&&n._x+n._w<=r._x+r._w&&n._y>=r._y&&n._y+n._h<=r._y+r._h},pos:function(t){return t=t||{},t._x=this._x,t._y=this._y,t._w=this._w,t._h=this._h,t},mbr:function(t){return t=t||{},this._mbr?(t._x=this._mbr._x,t._y=this._mbr._y,t._w=this._mbr._w,t._h=this._mbr._h,t):this.pos(t)},isAt:function(t,i){if(this.mapArea)return this.mapArea.containsPoint(t,i);if(this.map)return this.map.containsPoint(t,i);var h=this._mbr||this;return h._x<=t&&h._x+h._w>=t&&h._y<=i&&h._y+h._h>=i},move:function(t,i){return\"n\"===t.charAt(0)&&(this.y-=i),\"s\"===t.charAt(0)&&(this.y+=i),\"e\"!==t&&\"e\"!==t.charAt(1)||(this.x+=i),\"w\"!==t&&\"w\"!==t.charAt(1)||(this.x-=i),this},shift:function(t,i,h,s){return t&&(this.x+=t),i&&(this.y+=i),h&&(this.w+=h),s&&(this.h+=s),this},_cascade:function(t){if(t){var i,h=0,s=this._children,n=s.length;if(\"cos\"in t||\"sin\"in t)for(;h<n;++h)\"rotate\"in(i=s[h])&&i.rotate(t);else for(var r=this._x-t._x,e=this._y-t._y,_=this._w-t._w,o=this._h-t._h;h<n;++h)(i=s[h]).shift(r,e,_,o)}},attach:function(){for(var t,i=0,h=arguments,s=arguments.length;i<s;++i)(t=h[i])._parent&&t._parent.detach(t),t._parent=this,this._children.push(t);return this},detach:function(t){var i;if(!t){for(i=0;i<this._children.length;i++)this._children[i]._parent=null;return this._children=[],this}for(i=0;i<this._children.length;i++)this._children[i]===t&&this._children.splice(i,1);return t._parent=null,this},origin:function(t,i){if(\"string\"==typeof t)if(\"centre\"===t||\"center\"===t||-1===t.indexOf(\" \"))t=this._w/2,i=this._h/2;else{var h=t.split(\" \");\"top\"===h[0]?i=0:\"bottom\"===h[0]?i=this._h:\"middle\"!==h[0]&&\"center\"!==h[1]&&\"centre\"!==h[1]||(i=this._h/2),\"center\"===h[1]||\"centre\"===h[1]||\"middle\"===h[1]?t=this._w/2:\"left\"===h[1]?t=0:\"right\"===h[1]&&(t=this._w)}return this._origin.x=t,this._origin.y=i,this},rotate:function(t){var i,h;i=(this._x+this._origin.x-t.o.x)*t.cos+(this._y+this._origin.y-t.o.y)*t.sin+(t.o.x-this._origin.x),h=(this._y+this._origin.y-t.o.y)*t.cos-(this._x+this._origin.x-t.o.x)*t.sin+(t.o.y-this._origin.y),this._setter2d(\"_rotation\",this._rotation-t.deg),this._setter2d(\"_x\",i),this._setter2d(\"_y\",h)},_setter2d:function(i,h){if(this[i]!==h){var s,n=t.rectManager._pool.copy(this);if(\"_rotation\"===i)this._rotate(h);else if(\"_x\"===i||\"_y\"===i)(s=this._mbr)&&(s[i]-=this[i]-h,this._cbr&&(this._cbr[i]-=this[i]-h)),this[i]=h,this.trigger(\"Move\",n);else if(\"_h\"===i||\"_w\"===i){s=this._mbr;var r=this[i];this[i]=h,s&&this._calculateMBR(),\"_w\"===i?this.trigger(\"Resize\",{axis:\"w\",amount:h-r}):\"_h\"===i&&this.trigger(\"Resize\",{axis:\"h\",amount:h-r}),this.trigger(\"Move\",n)}else if(\"_z\"===i){var e=h<<0;h=h===e?e:e+1,this._globalZ=1e5*h+this[0],this[i]=h,this.trigger(\"Reorder\")}this[i]=h,this.trigger(\"Invalidate\"),t.rectManager._pool.recycle(n)}}}),t.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0)),this.points=t},t.polygon.prototype={containsPoint:function(t,i){var h,s,n=this.points,r=n.length/2,e=!1;for(h=0,s=r-1;h<r;s=h++)n[2*h+1]>i!=n[2*s+1]>i&&t<(n[2*s]-n[2*h])*(i-n[2*h+1])/(n[2*s+1]-n[2*h+1])+n[2*h]&&(e=!e);return e},shift:function(t,i){for(var h=0,s=this.points,n=s.length;h<n;h+=2)s[h]+=t,s[h+1]+=i},clone:function(){return new t.polygon(this.points.slice(0))},rotate:function(t){for(var i,h,s=0,n=this.points,r=n.length;s<r;s+=2)i=t.o.x+(n[s]-t.o.x)*t.cos+(n[s+1]-t.o.y)*t.sin,h=t.o.y-(n[s]-t.o.x)*t.sin+(n[s+1]-t.o.y)*t.cos,n[s]=i,n[s+1]=h},intersectRay:function(t,i){for(var h,s,n,r,e,_,o,a,c,u=this.points,l=1/0,f=t._x,y=i.x,x=t._y,g=i.y,b=0,d=u.length,m=u[d-2],p=u[d-1];b<d;b+=2)_=u[b],s=(m-f)*(c=(a=u[b+1])-p)-(p-x)*(o=_-m),r=(m-f)*g-(p-x)*y,0!==(e=y*c-g*o)?(h=s/e,(n=r/e)>=0&&n<=1&&h>=0&&h<l&&(l=h)):0!==s&&0!==r||((h=(m-f)*y+(p-x)*g)>=0&&h<l&&(l=h),(h=(_-f)*y+(a-x)*g)>=0&&h<l&&(l=h)),m=_,p=a;return l}},t.circle=function(t,i,h){this.x=t,this.y=i,this.radius=h,this.points=[];for(var s,n=0;n<16;n+=2)s=n*Math.PI/8,this.points[n]=this.x+Math.sin(s)*h,this.points[n+1]=this.y+Math.cos(s)*h},t.circle.prototype={containsPoint:function(t,i){var h=this.radius,s=this.x-t,n=this.y-i;return s*s+n*n<h*h},shift:function(t,i){this.x+=t,this.y+=i;for(var h=0,s=this.points,n=s.length;h<n;h+=2)s[h]+=t,s[h+1]+=i},rotate:function(){}},t.matrix=function(t){this.mtx=t,this.width=t[0].length,this.height=t.length},t.matrix.prototype={x:function(i){if(this.width===i.height){for(var h=[],s=0;s<this.height;s++){h[s]=[];for(var n=0;n<i.width;n++){for(var r=0,e=0;e<this.width;e++)r+=this.mtx[s][e]*i.mtx[e][n];h[s][n]=r}}return new t.matrix(h)}},e:function(t,i){return t<1||t>this.mtx.length||i<1||i>this.mtx[0].length?null:this.mtx[t-1][i-1]}};"},"hash":"0f0d0091173299d45c7b8fb18f854ef3"}