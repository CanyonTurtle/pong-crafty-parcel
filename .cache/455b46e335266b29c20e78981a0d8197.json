{"dependencies":[{"name":"./setup","loc":{"line":1,"column":23}},{"name":"./score","loc":{"line":2,"column":23}}],"generated":{"js":"\"use strict\";\n\nvar _setup = require(\"./setup\");\n\nvar Setup = _interopRequireWildcard(_setup);\n\nvar _score = require(\"./score\");\n\nvar Score = _interopRequireWildcard(_score);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nCrafty.c('CpuPaddle', {\n  start({ x, y, ball }) {\n    var ctx = this;\n    this.addComponent('Paddle');\n    this.cpuSpeed = Setup.scaleY(25);\n    this.startPaddle({\n      x,\n      y\n    });\n    this.yv = 0;\n    this.ball = ball;\n    this.pid = {\n      p: 0.1,\n      i: 0.001,\n      iAccumulator: 0,\n      iCap: 2,\n      d: 0.1,\n      error() {\n        var ballPredictedY = Setup.bounds.bottom / 2;\n        let ballCenterY = ball.y + ball.h / 2;\n        let ballCenterX = ball.x + ball.w / 2;\n        if (ball.vx > 0) {\n          ballPredictedY = ballCenterY + ball.vy * ((Setup.bounds.right - ballCenterX) / ball.vx);\n          if (ballPredictedY < Setup.bounds.top - 200 || ballPredictedY > Setup.bounds.bottom + 200) {\n            ballPredictedY = Setup.bounds.bottom / 2;\n          }\n        }\n        let paddleCenterY = ctx.y + ctx.h / 2;\n        return ballPredictedY - paddleCenterY;\n      },\n      step() {\n        this.iAccumulator = Math.min(this.iAccumulator + this.error() * this.i, this.iCap);\n        return this.error() * this.p + this.iAccumulator;\n      }\n    };\n    this.bind('movePaddles', function (dt) {\n      if (ctx.ball !== undefined) {\n        if (Score.cpuMode === 1) {\n          ctx.yv = ctx.pid.step();\n          ctx.y += ctx.yv;\n        } else {\n          ctx.y += Math.sign(ball.y - ctx.y) * ctx.cpuSpeed * (dt / 1000);\n        }\n      }\n    });\n  }\n});"},"hash":"18a8a53ae6459eb7f62c8ef6865e6e95"}