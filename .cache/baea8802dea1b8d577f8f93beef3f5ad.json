{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}}],"generated":{"js":"var Crafty = require('../core/core.js'),\n    document = window.document;\n\n/**@\n * #DOM\n * @category Graphics\n * @kind Component\n *\n * A component which renders entities as DOM nodes, specifically `<div>`s.\n */\nCrafty.c(\"DOM\", {\n    /**@\n     * #._element\n     * @comp DOM\n     * @kind Property\n     * The DOM element used to represent the entity.\n     */\n    _element: null,\n    //holds current styles, so we can check if there are changes to be written to the DOM\n    _cssStyles: null,\n\n    /**@\n     * #.avoidCss3dTransforms\n     * @comp DOM\n     * @kind Property\n     * \n     * Avoids using of CSS 3D Transform for positioning when true. Default value is false.\n     */\n    avoidCss3dTransforms: false,\n\n    init: function () {\n        this.requires(\"Renderable\");\n        \n        this._cssStyles = {\n            visibility: '',\n            left: '',\n            top: '',\n            width: '',\n            height: '',\n            zIndex: '',\n            opacity: '',\n            transformOrigin: '',\n            transform: ''\n        };\n        this._element = document.createElement(\"div\");\n\n        // Attach the entity to the dom layer\n        if (!this._customLayer){\n            this._attachToLayer( Crafty.s(\"DefaultDOMLayer\") );\n        }\n\n        this.bind(\"NewComponent\", this._updateClass);\n        this.bind(\"RemoveComponent\", this._removeClass);\n    },\n\n    remove: function(){\n        this._detachFromLayer();\n        this.unbind(\"NewComponent\", this._updateClass);\n        this.unbind(\"RemoveComponent\", this._removeClass);\n    },\n\n    /**@\n     * #.getDomId\n     * @comp DOM\n     * @kind Method\n     * \n     * @sign public this .getDomId()\n     *\n     * Get the Id of the DOM element used to represent the entity.\n     */\n    getDomId: function () {\n        return this._element.id;\n    },\n\n    // removes a component on RemoveComponent events\n    _removeClass: function(removedComponent) {\n        var comp,\n            c = this.__c,\n            str = \"\";\n        for (comp in c) {\n            if (comp !== removedComponent) {\n                str += ' ' + comp;\n            }\n        }\n        str = str.substr(1);\n        this._element.className = str;\n    },\n\n    // adds a class on NewComponent events\n    _updateClass: function() {\n        var comp,\n            c = this.__c,\n            str = \"\";\n        for (comp in c) {\n            str += ' ' + comp;\n        }\n        str = str.substr(1);\n        this._element.className = str;\n    },\n\n    /**@\n     * #.DOM\n     * @comp DOM\n     * @kind Method\n     * \n     * @trigger Draw - when the entity is ready to be drawn to the stage - { style:String, type:\"DOM\", co}\n     * @sign public this .DOM(HTMLElement elem)\n     * @param elem - HTML element that will replace the dynamically created one\n     *\n     * Pass a DOM element to use rather than one created. Will set `._element` to this value. Removes the old element.\n     * \n     * Will reattach the entity to the current draw layer\n     */\n    DOM: function (elem) {\n        if (elem && elem.nodeType) {\n            var layer = this._drawLayer;\n            this._detachFromLayer();\n            this._element = elem;\n            this._attachToLayer(layer);\n        }\n        return this;\n    },\n\n    /**@\n     * #.draw\n     * @comp DOM\n     * @kind Method\n     * @private\n     * \n     * @sign public this .draw(void)\n     *\n     * Updates the CSS properties of the node to draw on the stage.\n     */\n    draw: function () {\n        var style = this._element.style,\n            coord = this.__coord || [0, 0, 0, 0],\n            co = {\n                x: coord[0],\n                y: coord[1],\n                w: coord[2],\n                h: coord[3]\n            },\n            prefix = Crafty.support.prefix,\n            trans = [];\n\n        if (this._cssStyles.visibility !== this._visible) {\n            this._cssStyles.visibility = this._visible;\n            if (!this._visible) {\n                style.visibility = \"hidden\";\n            } else {\n                style.visibility = \"visible\";\n            }\n        }\n\n        //utilize CSS3 if supported\n        if (Crafty.support.css3dtransform && !this.avoidCss3dTransforms) {\n            trans.push(\"translate3d(\" + (~~this._x) + \"px,\" + (~~this._y) + \"px,0)\");\n        } else {\n            if (this._cssStyles.left !== this._x) {\n                this._cssStyles.left = this._x;\n                style.left = ~~ (this._x) + \"px\";\n            }\n            if (this._cssStyles.top !== this._y) {\n                this._cssStyles.top = this._y;\n                style.top = ~~ (this._y) + \"px\";\n            }\n        }\n\n        if (this._cssStyles.width !== this._w) {\n            this._cssStyles.width = this._w;\n            style.width = ~~ (this._w) + \"px\";\n        }\n        if (this._cssStyles.height !== this._h) {\n            this._cssStyles.height = this._h;\n            style.height = ~~ (this._h) + \"px\";\n        }\n        if (this._cssStyles.zIndex !== this._z) {\n            this._cssStyles.zIndex = this._z;\n            style.zIndex = this._z;\n        }\n\n        if (this._cssStyles.opacity !== this._alpha) {\n            this._cssStyles.opacity = this._alpha;\n            style.opacity = this._alpha;\n            style[prefix + \"Opacity\"] = this._alpha;\n        }\n\n        if (this._mbr) {\n            var origin = this._origin.x + \"px \" + this._origin.y + \"px\";\n            style.transformOrigin = origin;\n            style[prefix + \"TransformOrigin\"] = origin;\n            if (Crafty.support.css3dtransform) trans.push(\"rotateZ(\" + this._rotation + \"deg)\");\n            else trans.push(\"rotate(\" + this._rotation + \"deg)\");\n        }\n\n        if (this._flipX) {\n            trans.push(\"scaleX(-1)\");\n        }\n\n        if (this._flipY) {\n            trans.push(\"scaleY(-1)\");\n        }\n\n        if (this._cssStyles.transform !== trans.join(\" \")) {\n            this._cssStyles.transform = trans.join(\" \");\n            style.transform = this._cssStyles.transform;\n            style[prefix + \"Transform\"] = this._cssStyles.transform;\n        }\n\n        this.trigger(\"Draw\", {\n            style: style,\n            type: \"DOM\",\n            co: co\n        });\n\n        return this;\n    },\n\n    /**@\n     * #.css\n     * @comp DOM\n     * @kind Method\n     * \n     * @sign public css(String property, String value)\n     * @param property - CSS property to modify\n     * @param value - Value to give the CSS property\n     *\n     * @sign public  css(Object map)\n     * @param map - Object where the key is the CSS property and the value is CSS value\n     *\n     * Apply CSS styles to the element.\n     *\n     * Can pass an object where the key is the style property and the value is style value.\n     *\n     * For setting one style, simply pass the style as the first argument and the value as the second.\n     *\n     * The notation can be CSS or JS (e.g. `border-radius` or `borderRadius`).\n     *\n     * To return a value, pass the property.\n     *\n     * Note: For entities with \"Text\" component, some css properties are controlled by separate functions\n     * `.textFont()` and `.textColor()`, and ignore `.css()` settings. See Text component for details.\n     *\n     * @example\n     * ~~~\n     * this.css({'border-radius': '5px', 'text-decoration': 'line-through'});\n     * this.css(\"borderRadius\", \"10px\");\n     * this.css(\"border-radius\"); //returns 10px\n     * ~~~\n     */\n    css: function (obj, value) {\n        var key,\n            elem = this._element,\n            val,\n            style = elem.style;\n\n        //if an object passed\n        if (typeof obj === \"object\") {\n            for (key in obj) {\n                if (!obj.hasOwnProperty(key)) continue;\n                val = obj[key];\n                if (typeof val === \"number\") val += 'px';\n\n                style[Crafty.domHelper.camelize(key)] = val;\n            }\n        } else {\n            //if a value is passed, set the property\n            if (value) {\n                if (typeof value === \"number\") value += 'px';\n                style[Crafty.domHelper.camelize(obj)] = value;\n            } else { //otherwise return the computed property\n                return Crafty.domHelper.getStyle(elem, obj);\n            }\n        }\n\n        this.trigger(\"Invalidate\");\n\n        return this;\n    }\n});\n"},"hash":"ddf4bc549aec336c6bbc70ece3464183"}