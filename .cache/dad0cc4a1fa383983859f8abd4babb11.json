{"dependencies":[],"generated":{"js":"function i(i,t,r){this.keys=i,this.map=r,this.obj=t}var t,r=function(i){t=i||64,this.map={},this.boundsDirty=!1,this.boundsHash={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}},this.boundsCoords={max:{x:-1/0,y:-1/0},min:{x:1/0,y:1/0}}},s=\" \",n={};r.prototype={insert:function(t){var s,n,o=r.key(t),a=new i(o,t,this),h=0;for(h=o.x1;h<=o.x2;h++)for(s=o.y1;s<=o.y2;s++)n=h<<16^s,this.map[n]||(this.map[n]=[]),this.map[n].push(t);return this.boundsDirty=!0,a},search:function(i,t){var s,o,a,h,e,y=r.key(i,n),x=[];for(void 0===t&&(t=!0),s=y.x1;s<=y.x2;s++)for(o=y.y1;o<=y.y2;o++)if(e=this.map[s<<16^o])for(a=0;a<e.length;a++)x.push(e[a]);if(t){var m,f,u=[],p={};for(s=0,h=x.length;s<h;s++)(m=x[s])&&(f=m[0],m=m._cbr||m._mbr||m,!p[f]&&m._x<i._x+i._w&&m._x+m._w>i._x&&m._y<i._y+i._h&&m._y+m._h>i._y&&(p[f]=x[s]));for(m in p)u.push(p[m]);return u}return x},remove:function(i){var t,r,s=i.keys,n=i.obj,o=0;for(o=s.x1;o<=s.x2;o++)for(t=s.y1;t<=s.y2;t++)if(r=o<<16^t,this.map[r]){var a,h=this.map[r],e=h.length;for(a=0;a<e;a++)h[a]&&h[a][0]===n[0]&&h.splice(a,1)}this.boundsDirty=!0},refresh:function(i){var t,s,n,o,a,h=i.keys,e=i.obj;for(s=h.x1;s<=h.x2;s++)for(n=h.y1;n<=h.y2;n++)if(t=this.map[s<<16^n])for(a=t.length,o=0;o<a;o++)t[o]&&t[o][0]===e[0]&&t.splice(o,1);for(r.key(e,h),s=h.x1;s<=h.x2;s++)for(n=h.y1;n<=h.y2;n++)(t=this.map[s<<16^n])||(t=this.map[s<<16^n]=[]),t.push(e);return this.boundsDirty=!0,i},boundaries:function(){return this._updateBoundaries(),this.boundsCoords},_keyBoundaries:function(){return this._updateBoundaries(),this.boundsHash},_updateBoundaries:function(){if(this.boundsDirty){var i=this.boundsHash;i.max.x=-1/0,i.max.y=-1/0,i.min.x=1/0,i.min.y=1/0;var t=this.boundsCoords;t.max.x=-1/0,t.max.y=-1/0,t.min.x=1/0,t.min.y=1/0;var r,s;for(var n in this.map)if(this.map[n].length){var o=n>>16,a=n<<16>>16;if(a<0&&(o^=-1),o>=i.max.x){i.max.x=o;for(r in this.map[n])\"object\"==typeof(s=this.map[n][r])&&\"requires\"in s&&(t.max.x=Math.max(t.max.x,s.x+s.w))}if(o<=i.min.x){i.min.x=o;for(r in this.map[n])\"object\"==typeof(s=this.map[n][r])&&\"requires\"in s&&(t.min.x=Math.min(t.min.x,s.x))}if(a>=i.max.y){i.max.y=a;for(r in this.map[n])\"object\"==typeof(s=this.map[n][r])&&\"requires\"in s&&(t.max.y=Math.max(t.max.y,s.y+s.h))}if(a<=i.min.y){i.min.y=a;for(r in this.map[n])\"object\"==typeof(s=this.map[n][r])&&\"requires\"in s&&(t.min.y=Math.min(t.min.y,s.y))}}this.boundsDirty=!1}},traverseRay:function(i,s,o){var a=s.x,h=s.y;i={_x:i._x,_y:i._y,_w:0,_h:0};var e,y=this._keyBoundaries(),x=r.key(i,n),m=x.x1,f=x.y1,u=y.min.x,p=y.min.y,_=y.max.x,d=y.max.y,b=a>0?1:a<0?-1:0,c=h>0?1:h<0?-1:0,v=h>=0?(f+1)*t:f*t,l=-1/0,k=0,M=0,j=1/0,g=1/0;for(0!==a&&(e=1/a,j=((a>=0?(m+1)*t:m*t)-i._x)*e,k=t*b*e),0!==h&&(e=1/h,g=(v-i._y)*e,M=t*c*e);1===b&&m<u&&u!==1/0||-1===b&&m>_&&_!==-1/0||1===c&&f<p&&p!==1/0||-1===c&&f>d&&d!==-1/0;)j<g?(l=j,m+=b,j+=k):(l=g,f+=c,g+=M);for(var w;u<=m&&m<=_&&p<=f&&f<=d;){if(w=this.map[m<<16^f])for(var D=0;D<w.length;D++)if(o(w[D],l))return;j<g?(l=j,m+=b,j+=k):(l=g,f+=c,g+=M)}}},r.key=function(i,r){return i=i._cbr||i._mbr||i,r=r||{},r.x1=Math.floor(i._x/t),r.y1=Math.floor(i._y/t),r.x2=Math.floor((i._w+i._x)/t),r.y2=Math.floor((i._h+i._y)/t),r},r.hash=function(i){return i.x1+s+i.y1+s+i.x2+s+i.y2},i.prototype={update:function(i){r.hash(r.key(i,n))!==r.hash(this.keys)&&this.map.refresh(this)}},module.exports=r;"},"hash":"4ef2a136fe52de8b71fd28667be123e4"}