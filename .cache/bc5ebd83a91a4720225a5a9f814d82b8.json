{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}}],"generated":{"js":"var e=require(\"../core/core.js\"),t=window.document;e.extend({viewport:{clampToEntities:!0,_width:0,_height:0,_x:0,_y:0,_scale:1,bounds:null,scroll:function(t,i){this[t]=i,e.trigger(\"ViewportScroll\"),e.trigger(\"InvalidateViewport\")},rect_object:{_x:0,_y:0,_w:0,_h:0},rect:function(e){return e=e||this.rect_object,e._x=-this._x,e._y=-this._y,e._w=this._width/this._scale,e._h=this._height/this._scale,e},pan:function(){function t(t){a.tick(t.dt);var l=a.value();e.viewport.x=(1-l)*o+l*r,e.viewport.y=(1-l)*s+l*n,e.viewport._clamp(),a.complete&&(i(),e.trigger(\"CameraAnimationDone\"))}function i(){e.unbind(\"EnterFrame\",t)}var r,n,o,s,a;return e._preBind(\"StopCamera\",i),function(i,l,p,c){e.trigger(\"StopCamera\"),\"reset\"!==i&&(o=e.viewport._x,s=e.viewport._y,r=o-i,n=s-l,a=new e.easing(p,c),e.uniqueBind(\"EnterFrame\",t))}}(),follow:function(){function t(){var t=e.viewport._scale;e.viewport.scroll(\"_x\",-(this.x+this.w/2-e.viewport.width/2/t-r*t)),e.viewport.scroll(\"_y\",-(this.y+this.h/2-e.viewport.height/2/t-n*t)),e.viewport._clamp()}var i,r,n;return e._preBind(\"StopCamera\",function(){i&&(i.unbind(\"Move\",t),i.unbind(\"ViewportScale\",t),i.unbind(\"ViewportResize\",t))}),function(o,s,a){o&&o.has(\"2D\")&&(e.trigger(\"StopCamera\"),i=o,r=void 0!==s?s:0,n=void 0!==a?a:0,o.bind(\"Move\",t),o.bind(\"ViewportScale\",t),o.bind(\"ViewportResize\",t),t.call(o))}}(),centerOn:function(t,i){var r=t.x+e.viewport.x,n=t.y+e.viewport.y,o=t.w/2,s=t.h/2,a=r+o-e.viewport.width/2/e.viewport._scale,l=n+s-e.viewport.height/2/e.viewport._scale;e.viewport.pan(a,l,i)},zoom:function(){function t(){e.unbind(\"EnterFrame\",i)}function i(i){var n,h;c.tick(i.dt),n=Math.pow(o,c.value()),h=1===o?c.value():(1/n-1)/(1/o-1),e.viewport.scale(n*r),e.viewport.scroll(\"_x\",s*(1-h)+a*h),e.viewport.scroll(\"_y\",l*(1-h)+p*h),e.viewport._clamp(),c.complete&&(t(),e.trigger(\"CameraAnimationDone\"))}e._preBind(\"StopCamera\",t);var r,n,o,s,a,l,p,c;return function(t,h,w,u,g){t?(arguments.length<=2&&(u=h,h=e.viewport.x-e.viewport.width,w=e.viewport.y-e.viewport.height),e.trigger(\"StopCamera\"),r=e.viewport._scale,n=r*(o=t),s=e.viewport.x,l=e.viewport.y,a=-(h-e.viewport.width/(2*n)),p=-(w-e.viewport.height/(2*n)),c=new e.easing(u,g),e.uniqueBind(\"EnterFrame\",i)):e.viewport.scale(1)}}(),scale:function(t){this._scale=t||1,e.trigger(\"InvalidateViewport\"),e.trigger(\"ViewportScale\")},mouselook:function(){var t=!1,i=!1,r={};return function(n,o){if(\"boolean\"!=typeof n){if(t)switch(n){case\"move\":case\"drag\":if(!i)return;var s={x:o.clientX-r.x,y:o.clientY-r.y};r.x=o.clientX,r.y=o.clientY,e.viewport.x+=s.x,e.viewport.y+=s.y,e.viewport._clamp();break;case\"start\":e.trigger(\"StopCamera\"),r.x=o.clientX,r.y=o.clientY,i=!0;break;case\"stop\":i=!1}}else(t=n)?e.mouseObjs++:e.mouseObjs=Math.max(0,e.mouseObjs-1)}}(),_clamp:function(){if(this.clampToEntities){var t=e.clone(this.bounds)||e.clone(e.map.boundaries());t.max.x*=this._scale,t.min.x*=this._scale,t.max.y*=this._scale,t.min.y*=this._scale,t.max.x-t.min.x>e.viewport.width?e.viewport.x<(-t.max.x+e.viewport.width)/this._scale?e.viewport.x=(-t.max.x+e.viewport.width)/this._scale:e.viewport.x>-t.min.x&&(e.viewport.x=-t.min.x):e.viewport.x=-1*(t.min.x+(t.max.x-t.min.x)/2-e.viewport.width/2),t.max.y-t.min.y>e.viewport.height?e.viewport.y<(-t.max.y+e.viewport.height)/this._scale?e.viewport.y=(-t.max.y+e.viewport.height)/this._scale:e.viewport.y>-t.min.y&&(e.viewport.y=-t.min.y):e.viewport.y=-1*(t.min.y+(t.max.y-t.min.y)/2-e.viewport.height/2)}},init:function(i,r,n){e.createLayer(\"DefaultCanvasLayer\",\"Canvas\",{z:20}),e.createLayer(\"DefaultDOMLayer\",\"DOM\",{z:30}),e.createLayer(\"DefaultWebGLLayer\",\"WebGL\",{z:10}),this._defineViewportProperties(),this._x=0,this._y=0,this._scale=1,this.bounds=null,this._width=i||window.innerWidth,this._height=r||window.innerHeight,void 0===n&&(n=\"cr-stage\");var o;if(\"string\"==typeof n)o=t.getElementById(n);else{if(!(\"undefined\"!=typeof HTMLElement?n instanceof HTMLElement:n instanceof Element))throw new TypeError(\"stage_elem must be a string or an HTMLElement\");o=n}e.stage={x:0,y:0,fullscreen:!1,elem:o||t.createElement(\"div\")},i||r||(t.body.style.overflow=\"hidden\",e.stage.fullscreen=!0),e.addEvent(this,window,\"resize\",e.viewport.reload),e.addEvent(this,window,\"blur\",function(){e.settings.get(\"autoPause\")&&(e._paused||e.pause())}),e.addEvent(this,window,\"focus\",function(){e._paused&&e.settings.get(\"autoPause\")&&e.pause()}),e.settings.register(\"stageSelectable\",function(t){e.stage.elem.onselectstart=t?function(){return!0}:function(){return!1}}),e.settings.modify(\"stageSelectable\",!1),e.settings.register(\"stageContextMenu\",function(t){e.stage.elem.oncontextmenu=t?function(){return!0}:function(){return!1}}),e.settings.modify(\"stageContextMenu\",!1),e.settings.register(\"autoPause\",function(){}),e.settings.modify(\"autoPause\",!1),o||(t.body.appendChild(e.stage.elem),e.stage.elem.id=n);var s,a=e.stage.elem.style;if(a.width=this.width+\"px\",a.height=this.height+\"px\",a.overflow=\"hidden\",e.bind(\"ViewportResize\",function(){e.trigger(\"InvalidateViewport\")}),e.mobile){void 0!==typeof a.webkitTapHighlightColor&&(a.webkitTapHighlightColor=\"rgba(0,0,0,0)\");var l=t.createElement(\"meta\"),p=t.getElementsByTagName(\"head\")[0];(l=t.createElement(\"meta\")).setAttribute(\"name\",\"apple-mobile-web-app-capable\"),l.setAttribute(\"content\",\"yes\"),p.appendChild(l),e.addEvent(this,e.stage.elem,\"touchmove\",function(e){e.preventDefault()})}a.position=\"relative\",s=e.domHelper.innerPosition(e.stage.elem),e.stage.x=s.x,e.stage.y=s.y,e.uniqueBind(\"ViewportResize\",this._resize)},_resize:function(){e.stage.elem.style.width=e.viewport.width+\"px\",e.stage.elem.style.height=e.viewport.height+\"px\"},_defineViewportProperties:function(){Object.defineProperty(this,\"x\",{set:function(e){this.scroll(\"_x\",e)},get:function(){return this._x},configurable:!0}),Object.defineProperty(this,\"y\",{set:function(e){this.scroll(\"_y\",e)},get:function(){return this._y},configurable:!0}),Object.defineProperty(this,\"width\",{set:function(t){this._width=t,e.trigger(\"ViewportResize\")},get:function(){return this._width},configurable:!0}),Object.defineProperty(this,\"height\",{set:function(t){this._height=t,e.trigger(\"ViewportResize\")},get:function(){return this._height},configurable:!0})},reload:function(){var t,i=window.innerWidth,r=window.innerHeight;e.stage.fullscreen&&(this._width=i,this._height=r,e.trigger(\"ViewportResize\")),t=e.domHelper.innerPosition(e.stage.elem),e.stage.x=t.x,e.stage.y=t.y},reset:function(){e.viewport.mouselook(\"stop\"),e.trigger(\"StopCamera\"),e.viewport.scroll(\"_x\",0),e.viewport.scroll(\"_y\",0),e.viewport.scale(1)},onScreen:function(t){return e.viewport._x+t._x+t._w>0&&e.viewport._y+t._y+t._h>0&&e.viewport._x+t._x<e.viewport.width&&e.viewport._y+t._y<e.viewport.height}}});"},"hash":"fe1ddef1513dac1ceda5ecdef9672e4a"}