{"dependencies":[{"name":"./version","loc":{"line":1,"column":22}}],"generated":{"js":"function t(){var e=i++;return e in s?t():e}function e(t){if(null===t||\"object\"!=typeof t)return t;var i=t.constructor();for(var n in t)i[n]=e(t[n]);return i}var i,n,r,s,o,a,u,h,c,l=require(\"./version\"),f=function(t){return new f.fn.init(t)};r={},u=Array.prototype.slice,h=/\\s*,\\s*/,c=/\\s+/;var d=function(){i=1,n=0,s={},o={},a=[]};d(),f.fn=f.prototype={init:function(t){if(\"string\"!=typeof t)return t||(t=0)in s||(s[t]=this),t in s?(this[0]=t,this.length=1,this.__c||(this.__c={}),this._callbacks||f._addCallbackMethods(this),s[t]||(s[t]=this),s[t]):(this.length=0,this);var e,i,n,o,a,u,l,d=0,g=!1,m=!1;if(\"*\"===t){u=0;for(e in s)this[u]=+e,u++;return this.length=u,1===u?s[this[0]]:this}-1!==t.indexOf(\",\")?(m=!0,n=h):-1!==t.indexOf(\" \")&&(g=!0,n=c);for(e in s)if(s.hasOwnProperty(e))if(i=s[e],g||m){for(u=0,l=(o=t.split(n)).length,a=0;u<l;u++)i.__c[o[u]]&&a++;(g&&a===l||m&&a>0)&&(this[d++]=+e)}else i.__c[t]&&(this[d++]=+e);if(d>0&&!g&&!m&&this.extend(r[t]),o&&g)for(u=0;u<l;u++)this.extend(r[o[u]]);return this.length=d,1===d?s[this[d-1]]:(f._addCallbackMethods(this),this)},setName:function(t){var e=String(t);return this._entityName=e,this.trigger(\"NewEntityName\",e),this},getName:function(t){return this._entityName},addComponent:function(t){var e,i,n=0;for(e=1===arguments.length&&-1!==t.indexOf(\",\")?t.split(h):arguments;n<e.length;n++)if(!0!==this.__c[e[n]]&&(this.__c[e[n]]=!0,i=r[e[n]],this.extend(i),i&&\"required\"in i&&this.requires(i.required),i&&\"init\"in i&&i.init.call(this),i&&\"events\"in i)){var s=i.events;for(var o in s){var a=\"function\"==typeof s[o]?s[o]:i[s[o]];this.bind(o,a)}}return this.trigger(\"NewComponent\",e),this},toggleComponent:function(t){var e,i,n=0;if(arguments.length>1)for(e=arguments.length;n<e;n++)this.has(arguments[n])?this.removeComponent(arguments[n]):this.addComponent(arguments[n]);else if(-1!==t.indexOf(\",\"))for(e=(i=t.split(h)).length;n<e;n++)this.has(i[n])?this.removeComponent(i[n]):this.addComponent(i[n]);else this.has(t)?this.removeComponent(t):this.addComponent(t);return this},requires:function(t){return this.addComponent(t)},removeComponent:function(t,e){var i=r[t];if(this.trigger(\"RemoveComponent\",t),i&&\"events\"in i){var n=i.events;for(var s in n){var o=\"function\"==typeof n[s]?n[s]:i[n[s]];this.unbind(s,o)}}if(i&&\"remove\"in i&&i.remove.call(this,!1),!1===e&&i)for(var a in i)delete this[a];return delete this.__c[t],this},getId:function(){return this[0]},has:function(t){return!!this.__c[t]},attr:function(t,e,i,n){return 1===arguments.length&&\"string\"==typeof arguments[0]?this._attr_get(t):this._attr_set(t,e,i,n)},_attr_get:function(t,e){var i,n;return void 0!==e&&null!==e||(e=this),t.indexOf(\".\")>-1?(n=t.split(\".\"),i=n.shift(),n.join(\".\"),this._attr_get(n.join(\".\"),e[i])):e[t]},_attr_set:function(){var t,e,i;return\"string\"==typeof arguments[0]?(t=this._set_create_object(arguments[0],arguments[1]),e=!!arguments[2],i=arguments[3]||arguments[0].indexOf(\".\")>-1):(t=arguments[0],e=!!arguments[1],i=!!arguments[2]),e||this.trigger(\"Change\",t),i?this._recursive_extend(t,this):this.extend.call(this,t),this},_set_create_object:function(t,e){var i,n,r,s={};return t.indexOf(\".\")>-1?(n=(i=t.split(\".\")).shift(),r=i.join(\".\"),s[n]=this._set_create_object(r,e)):s[t]=e,s},_recursive_extend:function(t,e){var i;for(i in t)t[i].constructor===Object?e[i]=this._recursive_extend(t[i],e[i]):e[i]=t[i];return e},toArray:function(){return u.call(this,0)},timeout:function(t,e){return this.each(function(){var i=this;setTimeout(function(){t.call(i)},e)}),this},bind:function(t,e){if(1===this.length)this._bindCallback(t,e);else for(var i=0;i<this.length;i++){var n=s[this[i]];n&&n._bindCallback(t,e)}return this},uniqueBind:function(t,e){this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){var i,n;for(i=0;i<this.length;i++)(n=s[this[i]])&&n._unbindCallbacks(t,e);return this},trigger:function(t,e){if(1===this.length)this._runCallbacks(t,e);else for(var i=0;i<this.length;i++){var n=s[this[i]];n&&n._runCallbacks(t,e)}return this},each:function(t){for(var e=0,i=this.length;e<i;e++)s[this[e]]&&t.call(s[this[e]],e);return this},get:function(t){var e=this.length;if(void 0!==t){if(t>=e||t+e<0)return;return t>=0?s[this[t]]:s[this[t+e]]}for(var i=0,n=[];i<e;i++)s[this[i]]&&n.push(s[this[i]]);return n},clone:function(){var t,e,i=this.__c,n=f.e();for(t in i)n.addComponent(t);for(e in this)\"0\"!==e&&\"_global\"!==e&&\"_changed\"!==e&&\"function\"!=typeof this[e]&&\"object\"!=typeof this[e]&&(n[e]=this[e]);return n},setter:function(t,e){return this.defineField(t,function(){},e)},defineField:function(t,e,i){return f.defineField(this,t,e,i),this},destroy:function(){this.each(function(){var t;this.trigger(\"Remove\");for(var e in this.__c)(t=r[e])&&\"remove\"in t&&t.remove.call(this,!0);this._unbindAll(),delete s[this[0]]})}},f.fn.init.prototype=f.fn,f.extend=f.fn.extend=function(t){var e;if(!t)return this;for(e in t)this!==t[e]&&(this[e]=t[e]);return this},f._callbackMethods={_bindCallback:function(t,e){var i=this._callbacks[t];i||((i=this._callbacks[t]=(o[t]||(o[t]={}))[this[0]]=[]).context=this,i.depth=0),i.push(e)},_runCallbacks:function(t,e){if(this._callbacks[t]){var i,n=this._callbacks[t],r=n.length;for(n.depth++,i=0;i<r;i++)void 0===n[i]?n.depth<=1&&(n.splice(i,1),i--,r--,0===n.length&&(delete this._callbacks[t],delete o[t][this[0]])):n[i].call(this,e);n.depth--}},_unbindCallbacks:function(t,e){if(this._callbacks[t])for(var i=this._callbacks[t],n=0;n<i.length;n++)e&&i[n]!==e||delete i[n]},_unbindAll:function(){if(this._callbacks)for(var t in this._callbacks)this._callbacks[t]&&(this._unbindCallbacks(t),delete o[t][this[0]])}},f._addCallbackMethods=function(t){t.extend(f._callbackMethods),t._callbacks={}},f._addCallbackMethods(f),f.extend({0:\"global\",init:function(t,e,i){if(!this._preBindDone)for(var n=0;n<this._bindOnInit.length;n++){var r=this._bindOnInit[n];f.bind(r.event,r.handler)}return f.viewport.init(t,e,i),this.trigger(\"Load\"),this.timer.init(),this},_bindOnInit:[],_preBindDone:!1,_preBind:function(t,e){this._bindOnInit.push({event:t,handler:e})},getVersion:function(){return l},stop:function(t){if(f.trigger(\"CraftyStop\",t),this.timer.stop(),t){f.audio.remove();for(var e in f._systems)f._systems[e].destroy();if(f.stage&&f.stage.elem.parentNode){var i=document.createElement(\"div\");i.id=f.stage.elem.id,f.stage.elem.parentNode.replaceChild(i,f.stage.elem)}f._unbindAll(),f._addCallbackMethods(f),this._preBindDone=!1,d()}return this},pause:function(t){return(1===arguments.length?t:!this._paused)?(this.trigger(\"Pause\"),this._paused=!0,setTimeout(function(){f.timer.stop()},0),f.keydown={}):(this.trigger(\"Unpause\"),this._paused=!1,setTimeout(function(){f.timer.init()},0)),this},isPaused:function(){return this._paused},timer:function(){var t,e,i,r=\"fixed\",s=5,o=40,a=0,u=0,h=50,c=1e3/h;return{init:function(){void 0===i&&(i=(new Date).getTime()-c);var n=\"undefined\"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null);n?(t=function(){f.timer.step(),null!==t&&(e=n(t))})():t=setInterval(function(){f.timer.step()},1e3/h)},stop:function(){f.trigger(\"CraftyStopTimer\"),\"function\"!=typeof t&&clearInterval(t);var i=\"undefined\"!=typeof window&&(window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||null);i&&i(e),t=null},steptype:function(t,e){if(\"variable\"===t||\"semifixed\"===t)r=t,e&&(o=e),f.trigger(\"NewSteptype\",{mode:r,maxTimeStep:o});else{if(\"fixed\"!==t){if(void 0!==t)throw\"Invalid step type specified\";return{mode:r,maxTimeStep:\"variable\"===r||\"semifixed\"===r?o:s}}r=\"fixed\",e&&(s=e),f.trigger(\"NewSteptype\",{mode:r,maxTimeStep:s})}},step:function(){var t,e,h,l=0,d=(new Date).getTime();if(a>0&&f.trigger(\"MeasureWaitTime\",d-a),i+u>=d)a=d;else{var g=d-(i+u);g>20*c&&(u+=g-c,g=c),\"fixed\"===r?(l=Math.ceil(g/c),l=Math.min(l,s),e=c):\"variable\"===r?(l=1,e=g,e=Math.min(e,o)):\"semifixed\"===r&&(e=g/(l=Math.ceil(g/o)));for(var m=0;m<l;m++){h=d;var _={frame:n++,dt:e,gameTime:i};f.trigger(\"EnterFrameInput\",_),f.trigger(\"EnterFrame\",_),f.trigger(\"ExitFrame\",_),i+=e,d=(new Date).getTime(),f.trigger(\"MeasureFrameTime\",d-h)}l>0&&(t=d,f.trigger(\"PreRender\"),f.trigger(\"RenderScene\"),f.trigger(\"PostRender\"),d=(new Date).getTime(),f.trigger(\"MeasureRenderTime\",d-t)),a=d}},FPS:function(t){if(void 0===t)return h;c=1e3/(h=t),f.trigger(\"FPSChange\",t)},simulateFrames:function(t,e){for(e=e||c;t-- >0;){var i={frame:n++,dt:e};f.trigger(\"EnterFrameInput\",i),f.trigger(\"EnterFrame\",i),f.trigger(\"ExitFrame\",i)}f.trigger(\"PreRender\"),f.trigger(\"RenderScene\"),f.trigger(\"PostRender\")}}}(),e:function(){var e=t();return s[e]=null,s[e]=f(e),arguments.length>0&&s[e].addComponent.apply(s[e],arguments),s[e].setName(\"Entity #\"+e),s[e].addComponent(\"obj\"),f.trigger(\"NewEntity\",{id:e}),s[e]},c:function(t,e){r[t]=e},trigger:function(t,e){var i,n,r=o[t]||(o[t]={});for(i in r)r.hasOwnProperty(i)&&(n=r[i])&&0!==n.length&&n.context._runCallbacks(t,e)},bind:function(t,e){return this._bindCallback(t,e),e},uniqueBind:function(t,e){return this.unbind(t,e),this.bind(t,e)},one:function(t,e){var i=this,n=function(r){e.call(i,r),i.unbind(t,n)};return i.bind(t,n)},unbind:function(t,e){this._unbindCallbacks(t,e)},frame:function(){return n},components:function(){return r},isComp:function(t){return t in r},debug:function(t){return\"handlers\"===t?o:s},settings:function(){var t={},e={};return{register:function(t,i){e[t]=i},modify:function(i,n){e[i]&&(e[i].call(t[i],n),t[i]=n)},get:function(e){return t[e]}}}(),defineField:function(t,e,i,n){Object.defineProperty(t,e,{get:i,set:n,configurable:!1,enumerable:!0})},clone:e}),\"function\"==typeof define&&define(\"crafty\",[],function(){return f}),module.exports=f;"},"hash":"6af42faef82fd95dce38b4c70678aca6"}