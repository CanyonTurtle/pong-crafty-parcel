{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}}],"generated":{"js":"var Crafty = require('../core/core.js');\n\n\nmodule.exports = {\n    _scenes: {},\n    _current: null,\n\n    /**@\n     * #Crafty.scene\n     * @category Scenes, Stage\n     * @kind Method\n     * \n     * @trigger SceneChange - just before a new scene is initialized - { oldScene:String, newScene:String }\n     * @trigger SceneDestroy - just before the current scene is destroyed - { newScene:String  }\n     *\n     * @sign public void Crafty.scene(String sceneName, Function init[, Function uninit])\n     * @param sceneName - Name of the scene to add\n     * @param init - Function to execute when scene is played\n     * @param uninit - Function to execute before next scene is played, after entities with `2D` are destroyed\n     *\n     * This is equivalent to calling `Crafty.defineScene`.\n     *\n     * @sign public void Crafty.scene(String sceneName[, Data])\n     * @param sceneName - Name of scene to play\n     * @param Data - The init function of the scene will be called with this data as its parameter.  Can be of any type other than a function.\n     *\n     * This is equivalent to calling `Crafty.enterScene`.\n     *\n     * Method to create scenes on the stage. Pass an ID and function to register a scene.\n     *\n     * To play a scene, just pass the ID. When a scene is played, all\n     * previously-created entities with the `2D` component are destroyed. The\n     * viewport is also reset.\n     *\n     * You can optionally specify an arugment that will be passed to the scene's init function.\n     *\n     * If you want some entities to persist over scenes (as in, not be destroyed)\n     * simply add the component `Persist`.\n     *\n     * @example\n     * ~~~\n     * Crafty.defineScene(\"loading\", function() {\n     *     Crafty.background(\"#000\");\n     *     Crafty.e(\"2D, DOM, Text\")\n     *           .attr({ w: 100, h: 20, x: 150, y: 120 })\n     *           .text(\"Loading\")\n     *           .css({ \"border\": \"1px solid red\"})\n     *           .textColor(\"#FFFFFF\");\n     * });\n     *\n     * Crafty.defineScene(\"UFO_dance\",\n     *              function() {Crafty.background(\"#444\"); Crafty.e(\"UFO\");},\n     *              function() {...send message to server...});\n     *\n     * // An example of an init function which accepts arguments, in this case an object.\n     * Crafty.defineScene(\"square\", function(attributes) {\n     *     Crafty.background(\"#000\");\n     *     Crafty.e(\"2D, DOM, Color\")\n     *           .attr(attributes)\n     *           .color(\"red\");\n     * \n     * });\n     *\n     * ~~~\n     * This defines (but does not play) two scenes as discussed below.\n     * ~~~\n     * Crafty.enterScene(\"loading\");\n     * ~~~\n     * This command will clear the stage by destroying all `2D` entities (except\n     * those with the `Persist` component). Then it will set the background to\n     * black and display the text \"Loading\".\n     * ~~~\n     * Crafty.enterScene(\"UFO_dance\");\n     * ~~~\n     * This command will clear the stage by destroying all `2D` entities (except\n     * those with the `Persist` component). Then it will set the background to\n     * gray and create a UFO entity. Finally, the next time the game encounters\n     * another command of the form `Crafty.scene(scene_name)` (if ever), then the\n     * game will send a message to the server.\n     * ~~~\n     * Crafty.enterScene(\"square\", {x:10, y:10, w:20, h:20});\n     * ~~~\n     * This will clear the stage, set the background black, and create a red square with the specified position and dimensions.\n     * ~~~\n     */\n    scene: function (name, intro, outro) {\n        // If there's one argument, or the second argument isn't a function, play the scene\n        if (arguments.length === 1 || typeof(arguments[1]) !== \"function\") {\n            Crafty.enterScene(name, arguments[1]);\n            return;\n        }\n        // Otherwise, this is a call to create a scene\n        Crafty.defineScene(name, intro, outro);\n    },\n\n    /* \n     * #Crafty.defineScene\n     * @category Scenes, Stage\n     * @kind Method\n     *\n     * @sign public void Crafty.enterScene(String name[, Data])\n     * @param name - Name of the scene to run.\n     * @param Data - The init function of the scene will be called with this data as its parameter.  Can be of any type other than a function.\n     *\n     * @see Crafty.enterScene\n     * @see Crafty.scene\n     */\n    defineScene: function(name, init, uninit){\n        if (typeof init !== \"function\")\n            throw(\"Init function is the wrong type.\");\n        this._scenes[name] = {};\n        this._scenes[name].initialize = init;\n        if (typeof uninit !== 'undefined') {\n            this._scenes[name].uninitialize = uninit;\n        }\n        return;\n\n    },\n\n    /* \n     * #Crafty.enterScene\n     * @category Scenes, Stage\n     * @kind Method\n     * \n     * @trigger SceneChange - just before a new scene is initialized - { oldScene:String, newScene:String }\n     * @trigger SceneDestroy - just before the current scene is destroyed - { newScene:String  }\n     *\n     * @sign public void Crafty.enterScene(String name[, Data])\n     * @param name - Name of the scene to run.\n     * @param Data - The init function of the scene will be called with this data as its parameter.  Can be of any type other than a function.\n     * \n     * @see Crafty.defineScene\n     * @see Crafty.scene\n     */\n    enterScene: function(name, data){\n        if (typeof data === \"function\")\n            throw(\"Scene data cannot be a function\");\n\n        // ---FYI---\n        // this._current is the name (ID) of the scene in progress.\n        // this._scenes is an object like the following:\n        // {'Opening scene': {'initialize': fnA, 'uninitialize': fnB},\n        //  'Another scene': {'initialize': fnC, 'uninitialize': fnD}}\n\n        Crafty.trigger(\"SceneDestroy\", {\n            newScene: name\n        });\n        Crafty.viewport.reset();\n\n        Crafty(\"2D\").each(function () {\n            if (!this.has(\"Persist\")) this.destroy();\n        });\n        // uninitialize previous scene\n        if (this._current !== null && 'uninitialize' in this._scenes[this._current]) {\n            this._scenes[this._current].uninitialize.call(this);\n        }\n        // initialize next scene\n        var oldScene = this._current;\n        this._current = name;\n        Crafty.trigger(\"SceneChange\", {\n            oldScene: oldScene,\n            newScene: name\n        });\n           \n        if (this._scenes.hasOwnProperty(name)) {\n            this._scenes[name].initialize.call(this, data);\n        } else {\n            Crafty.error('The scene \"' + name + '\" does not exist');\n        }\n\n        return;\n\n    }\n};\n"},"hash":"d0fa84b4b5d6ce9bf17d969bdc109541"}