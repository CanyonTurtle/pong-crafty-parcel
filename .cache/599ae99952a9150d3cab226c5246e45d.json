{"dependencies":[{"name":"../core/core.js","loc":{"line":1,"column":21}}],"generated":{"js":"var t=require(\"../core/core.js\"),i=window.document;t.c(\"Particles\",{init:function(){this._Particles=t.clone(this._Particles),this._Particles.parentEntity=this,this._particlesPaused=!1},particles:function(e){if(!t.support.canvas||t.deactivateParticles)return this;var s,o,r,a,n;(s=i.createElement(\"canvas\")).width=t.viewport.width,s.height=t.viewport.height,s.style.position=\"absolute\",s.style.left=\"0px\",s.style.top=\"0px\",t.stage.elem.appendChild(s),o=s.getContext(\"2d\"),this._Particles.init(e),this.bind(\"Remove\",function(){t.stage.elem.removeChild(s)}).bind(\"RemoveComponent\",function(i){\"particles\"===i&&t.stage.elem.removeChild(s)}),r=this.x+t.viewport.x,a=this.y+t.viewport.y,this._Particles.position=this._Particles.vectorHelpers.create(r,a);var h={x:t.viewport.x,y:t.viewport.y};return this.bind(\"EnterFrame\",function(){this._particlesPaused||(r=this.x+t.viewport.x,a=this.y+t.viewport.y,this._Particles.viewportDelta={x:t.viewport.x-h.x,y:t.viewport.y-h.y},h={x:t.viewport.x,y:t.viewport.y},this._Particles.position=this._Particles.vectorHelpers.create(r,a),\"function\"==typeof t.rectManager.boundingRect?(n=t.rectManager.boundingRect(this._Particles.register))&&o.clearRect(n._x,n._y,n._w,n._h):o.clearRect(0,0,t.viewport.width,t.viewport.height),this._Particles.update(),this._Particles.render(o))}),this},_Particles:{presets:{maxParticles:150,size:18,sizeRandom:4,speed:1,speedRandom:1.2,lifeSpan:29,lifeSpanRandom:7,angle:65,angleRandom:34,startColour:[255,131,0,1],startColourRandom:[48,50,45,0],endColour:[245,35,0,0],endColourRandom:[60,60,60,0],sharpness:20,sharpnessRandom:10,spread:10,duration:-1,fastMode:!1,gravity:{x:0,y:.1},jitter:0,originOffset:{x:0,y:0},particles:[],active:!0,particleCount:0,elapsedFrames:0,emissionRate:0,emitCounter:0,particleIndex:0},init:function(t){this.position=this.vectorHelpers.create(0,0),void 0===t&&(t={});for(var i in this.presets)void 0!==t[i]?this[i]=t[i]:this[i]=this.presets[i];this.emissionRate=this.maxParticles/this.lifeSpan,this.positionRandom=this.vectorHelpers.create(this.spread,this.spread)},addParticle:function(){if(this.particleCount===this.maxParticles)return!1;var t=new this.particle(this.vectorHelpers);return this.initParticle(t),this.particles[this.particleCount]=t,this.particleCount++,!0},RANDM1TO1:function(){return 2*Math.random()-1},initParticle:function(i){i.position.x=t.viewport._scale*(this.position.x+this.originOffset.x+this.positionRandom.x*this.RANDM1TO1()),i.position.y=t.viewport._scale*(this.position.y+this.originOffset.y+this.positionRandom.y*this.RANDM1TO1());var e=(this.angle+this.angleRandom*this.RANDM1TO1())*(Math.PI/180),s=this.vectorHelpers.create(Math.sin(e),-Math.cos(e)),o=this.speed+this.speedRandom*this.RANDM1TO1();i.direction=this.vectorHelpers.multiply(s,o),i.size=t.viewport._scale*(this.size+this.sizeRandom*this.RANDM1TO1()),i.size=i.size<0?0:~~i.size,i.timeToLive=this.lifeSpan+this.lifeSpanRandom*this.RANDM1TO1(),i.sharpness=this.sharpness+this.sharpnessRandom*this.RANDM1TO1(),i.sharpness=i.sharpness>100?100:i.sharpness<0?0:i.sharpness,i.sizeSmall=~~(i.size/200*i.sharpness);var r=[this.startColour[0]+this.startColourRandom[0]*this.RANDM1TO1(),this.startColour[1]+this.startColourRandom[1]*this.RANDM1TO1(),this.startColour[2]+this.startColourRandom[2]*this.RANDM1TO1(),this.startColour[3]+this.startColourRandom[3]*this.RANDM1TO1()],a=[this.endColour[0]+this.endColourRandom[0]*this.RANDM1TO1(),this.endColour[1]+this.endColourRandom[1]*this.RANDM1TO1(),this.endColour[2]+this.endColourRandom[2]*this.RANDM1TO1(),this.endColour[3]+this.endColourRandom[3]*this.RANDM1TO1()];i.colour=r,i.deltaColour[0]=(a[0]-r[0])/i.timeToLive,i.deltaColour[1]=(a[1]-r[1])/i.timeToLive,i.deltaColour[2]=(a[2]-r[2])/i.timeToLive,i.deltaColour[3]=(a[3]-r[3])/i.timeToLive},update:function(){if(this.active&&this.emissionRate>0){var t=1/this.emissionRate;for(this.emitCounter++;this.particleCount<this.maxParticles&&this.emitCounter>t;)this.addParticle(),this.emitCounter-=t;this.elapsedFrames++,-1!==this.duration&&this.duration<this.elapsedFrames&&this.stop()}this.particleIndex=0,this.register=[];for(var i;this.particleIndex<this.particleCount;){var e=this.particles[this.particleIndex];if(e.timeToLive>0){e.direction=this.vectorHelpers.add(e.direction,this.gravity),e.position=this.vectorHelpers.add(e.position,e.direction),e.position=this.vectorHelpers.add(e.position,this.viewportDelta),this.jitter&&(e.position.x+=this.jitter*this.RANDM1TO1(),e.position.y+=this.jitter*this.RANDM1TO1()),e.timeToLive--;var s=e.colour[0]+=e.deltaColour[0],o=e.colour[1]+=e.deltaColour[1],r=e.colour[2]+=e.deltaColour[2],a=e.colour[3]+=e.deltaColour[3];(i=[]).push(\"rgba(\"+(s>255?255:s<0?0:~~s)),i.push(o>255?255:o<0?0:~~o),i.push(r>255?255:r<0?0:~~r),i.push((a>1?1:a<0?0:a.toFixed(2))+\")\"),e.drawColour=i.join(\",\"),this.fastMode||(i[3]=\"0)\",e.drawColourEnd=i.join(\",\")),this.particleIndex++}else this.particleIndex!==this.particleCount-1&&(this.particles[this.particleIndex]=this.particles[this.particleCount-1]),this.particleCount--;var n={};n._x=~~e.position.x,n._y=~~e.position.y,n._w=e.size,n._h=e.size,this.register.push(n)}},stop:function(){this.active=!1,this.elapsedFrames=0,this.emitCounter=0,this.parentEntity.trigger(\"ParticleEnd\")},render:function(i){for(var e=0,s=this.particleCount;e<s;e++){var o=this.particles[e],r=o.size,a=r>>1;if(!(o.position.x+r<0||o.position.y+r<0||o.position.x-r>t.viewport.width||o.position.y-r>t.viewport.height)){var n=~~o.position.x,h=~~o.position.y;if(this.fastMode)i.fillStyle=o.drawColour;else{var l=i.createRadialGradient(n+a,h+a,o.sizeSmall,n+a,h+a,a);l.addColorStop(0,o.drawColour),l.addColorStop(.9,o.drawColourEnd),i.fillStyle=l}i.fillRect(n,h,r,r)}}},particle:function(t){this.position=t.create(0,0),this.direction=t.create(0,0),this.size=0,this.sizeSmall=0,this.timeToLive=0,this.colour=[],this.drawColour=\"\",this.deltaColour=[],this.sharpness=0},vectorHelpers:{create:function(t,i){return{x:t,y:i}},multiply:function(t,i){return t.x*=i,t.y*=i,t},add:function(t,i){return t.x+=i.x,t.y+=i.y,t}}},pauseParticles:function(){this._particlesPaused=!0},resumeParticles:function(){this._particlesPaused=!1}});"},"hash":"9938b644f8464dfb575b2674c129b724"}